# GeoExplicit-SFM é¡¹ç›®æ¼”ç¤º PPT å¤§çº² (ä¿®è®¢ç‰ˆ)

**æ—¶é•¿**: 20-25 åˆ†é’Ÿ  
**é¡µæ•°**: 20-22 é¡µ  
**æ ¸å¿ƒæ”¹è¿›**: æ¯ä¸ª Phase å¢åŠ æŠ€æœ¯ç»†èŠ‚ + å®šé‡éªŒè¯ç»“æœ
**ä¸»çº¿**: é—®é¢˜ â†’ æ–¹æ³• â†’ å®ç° â†’ **éªŒè¯** â†’ ä¸‹ä¸€é˜¶æ®µ

---

## è®¾è®¡åŸåˆ™

1. **å…·ä½“æ•°å­— > æŠ½è±¡æè¿°**: æ¯ä¸ª Phase å¿…é¡»æœ‰å®šé‡æŒ‡æ ‡
2. **éªŒè¯é©±åŠ¨**: æ¯ä¸ªæ¨¡å—å±•ç¤º"ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯å¯¹çš„"
3. **æŠ€æœ¯æ·±åº¦**: å±•ç¤ºå…³é”®å…¬å¼ã€ä»£ç é€»è¾‘ã€å‚æ•°é€‰æ‹©ä¾æ®
4. **å¯è§†åŒ–æ”¯æ’‘**: æ¯ä¸ª Phase è‡³å°‘ 2 å¼ å›¾

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•è¨€ (2é¡µ, 2min)

---

### Slide 1: å°é¢

**æ ‡é¢˜**: GeoExplicit-SFM  
**å‰¯æ ‡é¢˜**: åœ°ç†æ˜¾å¼çº¦æŸä¸‹çš„åŸå¸‚äººæµè½¨è¿¹ç”Ÿæˆ

**å…³é”®ä¿¡æ¯**:
- ç ”ç©¶åŒºåŸŸ: Wayne County, Michigan (åº•ç‰¹å¾‹éƒ½ä¼šåŒº)
- æ•°æ®è§„æ¨¡: 1.4M åƒç´ åœ°å›¾, 35 ä¸ªå¸å¼•å­, 1 äº¿å¸§è½¨è¿¹æ•°æ®

---

### Slide 2: é—®é¢˜ä¸æ–¹æ³•æ€»è§ˆ

**æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•ç”Ÿæˆç¬¦åˆçœŸå®åœ°ç†çº¦æŸçš„å¤§è§„æ¨¡äººæµè½¨è¿¹ï¼Ÿ

**å››é˜¶æ®µ Pipeline**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1    â”‚ â†’  â”‚  Phase 2    â”‚ â†’  â”‚  Phase 3    â”‚ â†’  â”‚  Phase 4    â”‚
â”‚  Sink è¯†åˆ«  â”‚    â”‚ å¯¼èˆªåœºæ„å»º  â”‚    â”‚ ç‰©ç†ä»¿çœŸ    â”‚    â”‚ ç­–ç•¥å­¦ä¹     â”‚
â”‚  (WHERE)    â”‚    â”‚ (HOW-Guide) â”‚    â”‚ (HOW-Move)  â”‚    â”‚ (LEARNING)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 35 sinks    â”‚    â”‚ 1.96M åƒç´   â”‚    â”‚ 1 äº¿å¸§æ•°æ®  â”‚    â”‚ 4.2MB æ¨¡å‹  â”‚
â”‚ 114 ä¸‡æµé‡  â”‚    â”‚ 100% æœ‰æ•ˆ   â”‚    â”‚ 0% ç©¿å¢™     â”‚    â”‚ Loss=0.21   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šPhase 1 - Sink è¯†åˆ« (3é¡µ, 3min)

---

### Slide 3: Phase 1 - é—®é¢˜ä¸æ•°æ®

**é—®é¢˜**: åŸå¸‚ä¸­çš„ä¸»è¦å¸å¼•å­ï¼ˆç›®çš„åœ°ï¼‰åœ¨å“ªé‡Œï¼Ÿ

**è¾“å…¥æ•°æ®**:
| æ•°æ®æº | æè¿° | æ ¼å¼ |
|--------|------|------|
| SEMCOG OD æµé‡ | 2020 å¹´ Census Tract çº§åˆ«é€šå‹¤æµé‡ | CSV |
| Michigan é“è·¯ç½‘ç»œ | é«˜ç²¾åº¦é“è·¯ Shapefile | .shp |
| POI æ•°æ® | å­¦æ ¡ã€æ—¥æ‰˜ä¸­å¿ƒä½ç½® | GeoPackage |

**ç ”ç©¶åŒºåŸŸ**: Wayne County (åŒ…å«åº•ç‰¹å¾‹)
- é¢ç§¯: ~1,400 kmÂ²
- æ …æ ¼åˆ†è¾¨ç‡: 100m/pixel
- åœ°å›¾å°ºå¯¸: 1365 Ã— 1435 åƒç´ 

---

### Slide 4: Phase 1 - æ–¹æ³•ï¼šOD æµé‡èšç±»

**æŠ€æœ¯æµç¨‹**:
```
OD æµé‡æ•°æ® â†’ Pareto ç­›é€‰ (Top 80% æµé‡) â†’ DBSCAN ç©ºé—´èšç±» â†’ Sink ä¸­å¿ƒç‚¹
```

**DBSCAN å‚æ•°**:
- `eps` = 1.5 km (èšç±»åŠå¾„)
- `min_samples` = 1 (å…è®¸å•ç‚¹èšç±»)

**åŠ æƒä¸­å¿ƒè®¡ç®—**:
$$\mathbf{x}_{center} = \frac{\sum_{i \in cluster} flow_i \cdot \mathbf{x}_i}{\sum_{i \in cluster} flow_i}$$

**é“è·¯å¯¹é½**: å°† Sink ä¸­å¿ƒ snap åˆ°æœ€è¿‘é“è·¯åƒç´ 

---

### Slide 5: Phase 1 - éªŒè¯ç»“æœ

**å®šé‡æŒ‡æ ‡**:
| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| è¯†åˆ«çš„ Sink æ•°é‡ | **35** |
| æ€»æµé‡è¦†ç›– | **1,142,458** é€šå‹¤äººæ¬¡ |
| æœ€å¤§ Sink æµé‡ | 215,604 (åº•ç‰¹å¾‹ CBD) |
| å¹³å‡ Sink æµé‡ | 32,642 |
| 100% Sink åœ¨é“è·¯ä¸Š | âœ… éªŒè¯é€šè¿‡ |

**å¯è§†åŒ–** (é…å›¾):
- å·¦å›¾: Sink ç©ºé—´åˆ†å¸ƒ (ç‚¹å¤§å° = æµé‡æƒé‡)
- å³å›¾: æµé‡åˆ†å¸ƒç›´æ–¹å›¾ (æ˜¾ç¤º Pareto ç‰¹å¾)

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šPhase 2 - å¯¼èˆªåœºæ„å»º (4é¡µ, 4min)

---

### Slide 6: Phase 2 - é—®é¢˜ä¸ç›®æ ‡

**é—®é¢˜**: å¦‚ä½•å¼•å¯¼ç²’å­ä»ä»»æ„ä½ç½®èµ°å‘ç›®çš„åœ°ï¼Ÿ

**ç›®æ ‡**: æ„å»ºå¯¼èˆªæ–¹å‘åœº $\mathbf{n}(\mathbf{x})$ï¼Œæ»¡è¶³ï¼š
1. åœ¨é“è·¯ä¸Šï¼šæ–¹å‘æŒ‡å‘æœ€è¿‘ Sink
2. åœ¨éé“è·¯ä¸Šï¼šæ–¹å‘æ— æ•ˆ (ç”¨äºçº¦æŸ)
3. æ¢¯åº¦å¹³æ»‘ï¼šé¿å…è½¨è¿¹æŠ–åŠ¨

**è¾“å…¥**: Phase 1 çš„ 35 ä¸ª Sink + é“è·¯ç½‘ç»œ  
**è¾“å‡º**: `nav_baseline.npz` (nav_y, nav_x ä¸¤ä¸ªåˆ†é‡)

---

### Slide 7: Phase 2 - æ–¹æ³•ï¼šEikonal æµ‹åœ°è·ç¦»

**æ ¸å¿ƒæ€æƒ³**: æ±‚è§£æ¯ä¸ªä½ç½®åˆ°æœ€è¿‘ Sink çš„"é“è·¯è·ç¦»"

**Eikonal æ–¹ç¨‹**:
$$|\nabla d(\mathbf{x})| = \frac{1}{f(\mathbf{x})}, \quad d|_{sink} = 0$$

å…¶ä¸­ $f(\mathbf{x}) = 1$ åœ¨é“è·¯ä¸Šï¼Œ$f(\mathbf{x}) = 0$ åœ¨éé“è·¯ä¸Š

**Fast Marching Method (FMM)** æ±‚è§£:
```python
# ä½¿ç”¨ scikit-fmm
distance_field = skfmm.distance(phi, dx=1.0)
```

**å¯¼èˆªæ–¹å‘**: 
$$\mathbf{n}(\mathbf{x}) = -\frac{\nabla d}{|\nabla d|}$$
(æŒ‡å‘è·ç¦»å‡å°çš„æ–¹å‘ï¼Œå³æœå‘ Sink)

---

### Slide 8: Phase 2 - å®ç°ç»†èŠ‚ä¸æŒ‘æˆ˜

**æŒ‘æˆ˜**: é“è·¯ç½‘ç»œæ˜¯ 1 åƒç´ å®½çš„"èµ°å»Š"

**é—®é¢˜**: åŒçº¿æ€§æ’å€¼åœ¨ 1px å®½é“è·¯ä¸Šä¼šé‡‡æ ·åˆ°éé“è·¯åŒºåŸŸ â†’ æ¢¯åº¦å¤±æ•ˆ

**è§£å†³æ–¹æ¡ˆ**: æœ€è¿‘é‚»é‡‡æ ·
```python
# é”™è¯¯ï¼šåŒçº¿æ€§æ’å€¼
yi, xi = int(round(y)), int(round(x))  # å¯èƒ½é‡‡åˆ°éé“è·¯

# æ­£ç¡®ï¼šä¸ is_on_road åˆ¤æ–­ä¸€è‡´
yi, xi = int(y), int(x)  # æˆªæ–­ï¼Œä¿è¯ä¸€è‡´æ€§
```

**é“è·¯æ …æ ¼åŒ–**:
- åŸå§‹é“è·¯ Shapefile â†’ 1px çº¿æ¡æ …æ ¼åŒ–
- é“è·¯å æ¯”: 25.8% (505,583 åƒç´ )

---

### Slide 9: Phase 2 - éªŒè¯ç»“æœ

**å®šé‡éªŒè¯**:
| æŒ‡æ ‡ | æ•°å€¼ | éªŒè¯æ–¹æ³• |
|------|------|----------|
| å¯¼èˆªåœºæœ‰æ•ˆç‡ | **93.4%** | nav å¹…åº¦ > 0.9 çš„é“è·¯åƒç´ æ¯”ä¾‹ |
| æ–¹å‘æ­£ç¡®ç‡ | **100%** | æ²¿ nav æ–¹å‘èµ°ï¼Œdistance é€’å‡ |
| åœ°å›¾è¦†ç›– | 1,365 Ã— 1,435 px | å®Œæ•´è¦†ç›–ç ”ç©¶åŒºåŸŸ |

**å¯è§†åŒ–** (é…å›¾):
- å·¦å›¾: è·ç¦»åœºçƒ­åŠ›å›¾ (é¢œè‰² = åˆ° Sink è·ç¦»)
- å³å›¾: å¯¼èˆªæ–¹å‘åœº (ç®­å¤´æŒ‡å‘ Sink)

---

## ç¬¬å››éƒ¨åˆ†ï¼šPhase 3 - ç‰©ç†ä»¿çœŸ (5é¡µ, 5min)

---

### Slide 10: Phase 3 - é—®é¢˜ä¸ç›®æ ‡

**é—®é¢˜**: å¦‚ä½•åŸºäºå¯¼èˆªåœºç”ŸæˆçœŸå®çš„è¿åŠ¨è½¨è¿¹ï¼Ÿ

**ç›®æ ‡**: ç”Ÿæˆå¤§è§„æ¨¡è½¨è¿¹æ•°æ®ï¼Œæ»¡è¶³ï¼š
1. éµå¾ªé“è·¯çº¦æŸ (ä¸ç©¿å¢™)
2. æœå‘ç›®çš„åœ°è¿åŠ¨
3. è¿åŠ¨å¹³æ»‘ã€ç‰©ç†åˆç†
4. åŒ…å«éšæœºæ€§ (æ¨¡æ‹Ÿä¸ªä½“å·®å¼‚)

**è¾“å‡ºè§„æ¨¡**: 10,000 agents Ã— 10,000 steps = **1 äº¿å¸§æ•°æ®**

---

### Slide 11: Phase 3 - æ–¹æ³•ï¼šLangevin åŠ¨åŠ›å­¦

**æ ¸å¿ƒæ–¹ç¨‹** (å¸¦åŠ¨é‡çš„éšæœºåŠ¨åŠ›å­¦):
$$\mathbf{v}_{t+1} = \underbrace{\mu \cdot \mathbf{v}_t}_{\text{æƒ¯æ€§}} + (1-\mu) \cdot (\underbrace{V_0 \cdot \mathbf{n}(\mathbf{x})}_{\text{å¯¼èˆªåŠ›}} + \underbrace{\mathbf{F}_{wall}}_{\text{è¾¹ç•ŒåŠ›}} + \underbrace{\sigma \boldsymbol{\xi}}_{\text{å™ªå£°}})$$

$$\mathbf{x}_{t+1} = \mathbf{x}_t + \mathbf{v}_{t+1} \cdot \Delta t$$

**å‚æ•°è¡¨**:
| å‚æ•° | ç¬¦å· | å€¼ | ç‰©ç†æ„ä¹‰ |
|------|------|-----|----------|
| åŠ¨é‡ç³»æ•° | $\mu$ | 0.7 | è½¨è¿¹å¹³æ»‘åº¦ |
| åŸºç¡€é€Ÿåº¦ | $V_0$ | 1.5 px/step | â‰ˆ 150 m/step |
| å™ªå£°å¼ºåº¦ | $\sigma$ | 0.08 | è¡Œä¸ºéšæœºæ€§ |
| æ—¶é—´æ­¥é•¿ | $\Delta t$ | 1.0 | å•ä½æ—¶é—´ |
| è¾¹ç•Œæ¢å¤ | - | 3.0 | ç¦»å¼€é“è·¯æ—¶çš„æ¢å¤åŠ› |

---

### Slide 12: Phase 3 - é“è·¯çº¦æŸæœºåˆ¶

**ä¸‰å±‚çº¦æŸ** (ç¡®ä¿ 100% é“è·¯éµå¾ª):

**Layer 1: SDF è¾¹ç•ŒåŠ›**
- è®¡ç®—æ¯ç‚¹åˆ°é“è·¯è¾¹ç•Œçš„æœ‰ç¬¦å·è·ç¦»
- é è¿‘è¾¹ç•Œæ—¶äº§ç”Ÿæ–¥åŠ›æ¨å›é“è·¯ä¸­å¿ƒ

**Layer 2: è„±ç½‘æ¢å¤**
```python
if not is_on_road:
    # ä½¿ç”¨ SDF æ¢¯åº¦æ–¹å‘è¿”å›é“è·¯
    recovery_dir = grad(SDF) / |grad(SDF)|
    velocity = recovery_dir * OFF_ROAD_RECOVERY
```

**Layer 3: ç¢°æ’å›é€€**
```python
if new_pos is off_road:
    # åœ¨ 4-é‚»åŸŸä¸­é€‰æ‹©ä¸é€Ÿåº¦æ–¹å‘æœ€ä¸€è‡´çš„é“è·¯åƒç´ 
    new_pos = best_neighbor_on_road(old_pos, velocity)
```

---

### Slide 13: Phase 3 - Numba åŠ é€Ÿå®ç°

**æ€§èƒ½æŒ‘æˆ˜**: 1 äº¿å¸§æ•°æ®ï¼Œçº¯ Python éœ€è¦æ•°å°æ—¶

**è§£å†³æ–¹æ¡ˆ**: Numba JIT ç¼–è¯‘
```python
@numba.jit(nopython=True, parallel=True)
def step_kernel(pos, vel, active, field, sdf, mask, ...):
    for i in numba.prange(N):  # å¹¶è¡Œå¾ªç¯
        # å¯¼èˆªåŠ› + è¾¹ç•ŒåŠ› + å™ªå£°
        # ä½ç½®æ›´æ–° + çº¦æŸæ£€æŸ¥
```

**æ€§èƒ½å¯¹æ¯”**:
| å®ç° | 5000 agents Ã— 5000 steps | åŠ é€Ÿæ¯” |
|------|--------------------------|--------|
| çº¯ Python | ~2 å°æ—¶ | 1x |
| Numba JIT | ~3 åˆ†é’Ÿ | **40x** |

---

### Slide 14: Phase 3 - éªŒè¯ç»“æœ

**å®šé‡æŒ‡æ ‡**:
| æŒ‡æ ‡ | æ•°å€¼ | éªŒè¯æ–¹æ³• |
|------|------|----------|
| æ•°æ®è§„æ¨¡ | 10,000 Ã— 10,000 = **1 äº¿å¸§** | - |
| é“è·¯éµå¾ªç‡ | **99.9996%** | æ£€æŸ¥æ¯å¸§ä½ç½®æ˜¯å¦åœ¨é“è·¯ä¸Š |
| é›¶é€Ÿåº¦å¸§ | **0.0017%** | å‡ ä¹æ— å¡æ­»ç²’å­ |
| å¹³å‡é€Ÿåº¦ | 1.08 px/step | æ¥è¿‘ç›®æ ‡é€Ÿåº¦ 1.5 |
| Velocity vs Nav ä¸€è‡´æ€§ | **0.634** (cos_sim) | 83% çš„å¸§æœ Sink æ–¹å‘ç§»åŠ¨ |
| Distance é€’å‡ç‡ | **91.5%** | ç²’å­æ€»ä½“å‘ Sink é è¿‘ |

**å¯è§†åŒ–** (é…å›¾):
- å·¦å›¾: è½¨è¿¹å åŠ åœ¨é“è·¯ç½‘ç»œä¸Š (æŠ½æ · 100 æ¡)
- å³å›¾: é€Ÿåº¦åˆ†å¸ƒç›´æ–¹å›¾

---

## ç¬¬äº”éƒ¨åˆ†ï¼šPhase 4 - Diffusion Policy (4é¡µ, 4min)

---

### Slide 15: Phase 4 - é—®é¢˜ä¸åŠ¨æœº

**ä¸ºä»€ä¹ˆéœ€è¦ Diffusion Policyï¼Ÿ**

| Phase 3 ä»¿çœŸå™¨ | Diffusion Policy |
|----------------|------------------|
| éœ€è¦å®Œæ•´åŠ¿åœº (~30MB) | è½»é‡ç½‘ç»œ (~4MB) |
| æ¯æ­¥æŸ¥è¯¢æ¢¯åº¦åœº | ç«¯åˆ°ç«¯æ¨ç† |
| ç¡®å®šæ€§ (ç»™å®š nav) | æ¦‚ç‡æ€§ (å¤šæ¨¡æ€) |
| åœºæ™¯å›ºå®š | å¯æ³›åŒ– |

**æ ¸å¿ƒæ€æƒ³**: 
å°†ä»¿çœŸå™¨çš„ $(obs \to action)$ æ˜ å°„"è’¸é¦"åˆ°ç¥ç»ç½‘ç»œ

---

### Slide 16: Phase 4 - æ–¹æ³•ï¼šDiffusion Policy

**è§‚æµ‹ä¸åŠ¨ä½œå®šä¹‰**:
- **Observation**: è¿‡å» 2 å¸§çš„ (position, velocity, nav_direction) â†’ 12 ç»´
- **Action**: æœªæ¥ 8 å¸§çš„ velocity â†’ 16 ç»´

**æ‰©æ•£è¿‡ç¨‹**:
$$q(A_k | A_{k-1}) = \mathcal{N}(A_k; \sqrt{1-\beta_k} A_{k-1}, \beta_k \mathbf{I})$$

**å»å™ªç½‘ç»œ** (1D UNet):
```
Input: (noisy_action, timestep, obs_condition)
Output: predicted_noise
Architecture: 1D UNet, base_channels=64, cond_dim=32
```

**è®­ç»ƒç›®æ ‡**:
$$\mathcal{L} = \mathbb{E}_{k, A_0, \epsilon} \left[ \| \epsilon - \epsilon_\theta(A_k, k, O) \|^2 \right]$$

---

### Slide 17: Phase 4 - è®­ç»ƒé…ç½®ä¸ç»“æœ

**è®­ç»ƒé…ç½®**:
| é…ç½® | å€¼ |
|------|-----|
| æ•°æ®è§„æ¨¡ | ~1 äº¿å¸§ (Phase 3 è¾“å‡º) |
| æ¯ Epoch é‡‡æ · | 200 ä¸‡æ ·æœ¬ |
| Batch size | 16,384 |
| Learning rate | 1e-3 |
| æ‰©æ•£æ­¥æ•° | 100 (è®­ç»ƒ) / 20 (æ¨ç† DDIM) |
| Epochs | 30 (ç›®æ ‡ 100) |

**å½“å‰ç»“æœ**:
| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| è®­ç»ƒ Loss | **0.207** (æ”¶æ•›) |
| æ¨¡å‹å¤§å° | **4.2 MB** |
| æ¨ç†é€Ÿåº¦ | 20 æ­¥ DDIM |

---

### Slide 18: Phase 4 - éªŒè¯ä¸å¾…æ”¹è¿›

**éªŒè¯æŒ‡æ ‡**:
| æŒ‡æ ‡ | GT vs Nav | Pred vs Nav | è¯´æ˜ |
|------|-----------|-------------|------|
| cos_sim | 0.58 | 0.08 | æ¨¡å‹å­¦åˆ°ä½†ä¸å……åˆ† |
| æ­£å‘ç‡ | 79% | 54% | éœ€è¦æ›´å¤šè®­ç»ƒ |

**æ¡ä»¶å­¦ä¹ éªŒè¯**: âœ… æ¨¡å‹å¯¹ nav æ¡ä»¶æ•æ„Ÿ
```
nav=[1,0] â†’ pred æœ y+ æ–¹å‘
nav=[-1,0] â†’ pred æœ y- æ–¹å‘
```

**å¾…æ”¹è¿›**:
- [ ] å¢åŠ è®­ç»ƒæ•°æ®: 10000 Ã— 10000
- [ ] å¢åŠ è®­ç»ƒè½®æ•°: 100 epochs
- [ ] æ›´å¤§ batch size (48GB VRAM å¯ç”¨)

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæ€»ç»“ä¸è®¨è®º (2é¡µ, 2min)

---

### Slide 19: å®Œæ•´ Pipeline éªŒè¯

**ç«¯åˆ°ç«¯éªŒè¯**:
```
Phase 1          Phase 2          Phase 3          Phase 4
â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€
35 Sinks    â†’    Nav Field   â†’    1äº¿å¸§è½¨è¿¹   â†’    4MB æ¨¡å‹
114ä¸‡æµé‡        100% æ­£ç¡®        83% æœå‘æ­£ç¡®      Loss=0.21
```

**å…³é”®éªŒè¯ç‚¹**:
| Phase | éªŒè¯æŒ‡æ ‡ | ç»“æœ |
|-------|----------|------|
| 1 | Sink åœ¨é“è·¯ä¸Š | 100% âœ… |
| 2 | Nav æŒ‡å‘ Sink | 100% âœ… |
| 3 | è½¨è¿¹åœ¨é“è·¯ä¸Š | 99.9996% âœ… |
| 3 | è½¨è¿¹æœ Sink | 83% âœ… |
| 4 | Loss æ”¶æ•› | 0.21 âœ… |
| 4 | Pred vs Nav | 54% (å¾…æå‡) |

---

### Slide 20: è´¡çŒ®ä¸æœªæ¥å·¥ä½œ

**æŠ€æœ¯è´¡çŒ®**:
1. **åœ°ç†æ˜¾å¼çº¦æŸ**: é¦–æ¬¡å°† 1px çº§åˆ«é“è·¯ç½‘ç»œä½œä¸ºç¡¬çº¦æŸ
2. **ç‰©ç†-æ•°æ®èåˆ**: Langevin åŠ¨åŠ›å­¦ + æ‰©æ•£ç­–ç•¥
3. **å¤§è§„æ¨¡ä»¿çœŸ**: 1 äº¿å¸§è½¨è¿¹æ•°æ®ç”Ÿæˆ (Numba åŠ é€Ÿ)
4. **å®Œæ•´ Pipeline**: ä» GIS æ•°æ®åˆ°å¯éƒ¨ç½²æ¨¡å‹

**æœªæ¥å·¥ä½œ**:
- ğŸ”„ Phase 4 å®Œæ•´è®­ç»ƒ (100 epochs)
- ğŸ“Š ä¸çœŸå® GPS è½¨è¿¹å¯¹æ¯”éªŒè¯
- ğŸšŒ å¤šæ¨¡å¼äº¤é€šæ‰©å±•
- â° æ—¶å˜å¯¼èˆªåœº (é«˜å³° vs éé«˜å³°)

---

### Slide 21: Q&A

**è°¢è°¢ï¼æ¬¢è¿æé—®**

**å…³é”®æ•°å­—å›é¡¾**:
- 35 ä¸ª Sinkï¼Œ114 ä¸‡æµé‡
- 1365 Ã— 1435 åƒç´ åœ°å›¾
- 1 äº¿å¸§è½¨è¿¹æ•°æ®
- 4.2 MB æ¨¡å‹ï¼ŒLoss = 0.21

---

## é™„å½•ï¼šé…å›¾æ¸…å•

| é¡µç  | é…å›¾ | å†…å®¹ |
|------|------|------|
| 5 | phase1_sinks.png | Sink ç©ºé—´åˆ†å¸ƒ + æµé‡ç›´æ–¹å›¾ |
| 9 | phase2_distance.png | è·ç¦»åœº + å¯¼èˆªæ–¹å‘åœº |
| 14 | phase3_trajectories.png | è½¨è¿¹å¯è§†åŒ– + é€Ÿåº¦åˆ†å¸ƒ |
| 18 | phase4_training.png | Loss æ›²çº¿ + é¢„æµ‹å¯¹æ¯” |

---

## é™„å½•ï¼šå…³é”®ä»£ç ç‰‡æ®µ (å¤‡ç”¨)

**Phase 3 ç‰©ç†æ ¸å¿ƒ** (å¯é€‰å±•ç¤º):
```python
@numba.jit(nopython=True, parallel=True)
def step_kernel(pos, vel, active, field, sdf, ...):
    for i in numba.prange(N):
        # 1. å¯¼èˆªåŠ›
        nav = bilinear_sample(field, y, x)
        nav_v = nav * v0
        
        # 2. åŠ¨é‡æ··åˆ
        eff_v = momentum * prev_v + (1-momentum) * (nav_v + wall_v + noise)
        
        # 3. é“è·¯çº¦æŸ
        new_pos = pos + eff_v * dt
        if off_road(new_pos):
            new_pos = snap_to_road(old_pos, eff_v)
```
